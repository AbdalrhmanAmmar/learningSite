<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UWorld CPA - Financial Accounting and Reporting</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");

      body {
        font-family: "Inter", sans-serif;
      }

      .sidebar-transition {
        transition: all 0.3s ease;
      }

      .timer-pulse {
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
        }
        70% {
          box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
        }
      }

      .question-highlight {
        background: linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0) 100%);
      }

      .tab-active {
        border-bottom: 3px solid #3b82f6;
        color: #3b82f6;
        font-weight: 600;
      }

      .correct-answer {
        border-left: 4px solid #10b981;
        background-color: rgba(16, 185, 129, 0.05);
      }

      .incorrect-answer {
        border-left: 4px solid #ef4444;
        background-color: rgba(239, 68, 68, 0.05);
      }

      .scrollbar-thin {
        scrollbar-width: thin;
        scrollbar-color: #cbd5e1 #f1f5f9;
      }

      .scrollbar-thin::-webkit-scrollbar {
        width: 6px;
      }

      .scrollbar-thin::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 3px;
      }

      .scrollbar-thin::-webkit-scrollbar-thumb {
        background-color: #cbd5e1;
        border-radius: 3px;
      }

      .exhibit-hover:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
      }

      .highlight-yellow {
        background-color: rgba(253, 224, 71, 0.3);
      }

      .highlight-blue {
        background-color: rgba(96, 165, 250, 0.3);
      }

      .highlight-green {
        background-color: rgba(52, 211, 153, 0.3);
      }

      /* Modal */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 50;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }
      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }
      .modal-content {
        background: white;
        padding: 2rem;
        border-radius: 0.75rem;
        max-width: 600px;
        width: 90%;
        transform: scale(0.95);
        transition: all 0.3s ease;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }
      .modal-overlay.active .modal-content {
        transform: scale(1);
      }

      /* Popover for Corrections */
      .correction-popover {
        position: absolute;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 0.5rem;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        z-index: 40;
        width: 350px;
        display: none;
        animation: fadeIn 0.2s ease-out;
      }
      .correction-popover.active {
        display: block;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .correction-option {
        padding: 0.75rem 1rem;
        cursor: pointer;
        border-bottom: 1px solid #f3f4f6;
        transition: background-color 0.2s;
      }
      .correction-option:first-child {
        border-top-left-radius: 0.5rem;
        border-top-right-radius: 0.5rem;
      }
      .correction-option:last-child {
        border-bottom: none;
        border-bottom-left-radius: 0.5rem;
        border-bottom-right-radius: 0.5rem;
      }
      .correction-option:hover {
        background-color: #f3f4f6;
      }

      /* Toast Notification */
      .toast-container {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        z-index: 60;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        pointer-events: none;
      }
      .toast {
        background: white;
        border-left: 4px solid #3b82f6;
        padding: 1rem;
        border-radius: 0.5rem;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        transform: translateX(120%);
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        min-width: 300px;
        pointer-events: auto;
      }
      .toast.show {
        transform: translateX(0);
      }
      .toast-success { border-left-color: #10b981; }
      .toast-warning { border-left-color: #f59e0b; }
      .toast-error { border-left-color: #ef4444; }

      /* Calculator Styles */
      .calc-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 0.5rem;
      }
      .calc-btn {
        padding: 1rem;
        background: #f3f4f6;
        border-radius: 0.5rem;
        font-weight: 600;
        text-align: center;
        transition: background 0.2s;
      }
      .calc-btn:hover { background: #e5e7eb; }
      .calc-btn.operator { background: #dbeafe; color: #2563eb; }
      .calc-btn.equal { background: #2563eb; color: white; grid-column: span 2; }
      .calc-display {
        grid-column: span 4;
        background: #1f2937;
        color: white;
        padding: 1rem;
        border-radius: 0.5rem;
        text-align: right;
        font-size: 1.5rem;
        font-family: monospace;
        margin-bottom: 1rem;
      }

      /* Spreadsheet Styles */
      .spreadsheet-container {
        overflow-x: auto;
      }
      .spreadsheet-table {
        border-collapse: collapse;
        width: 100%;
        min-width: 600px;
      }
      .spreadsheet-table th, .spreadsheet-table td {
        border: 1px solid #e5e7eb;
        padding: 0.5rem;
        min-width: 80px;
        text-align: center;
      }
      .spreadsheet-table th {
        background: #f9fafb;
        font-weight: 600;
        color: #4b5563;
      }
      .spreadsheet-table td:first-child {
        background: #f9fafb;
        font-weight: 600;
        color: #4b5563;
        width: 40px;
        min-width: 40px;
      }
      .spreadsheet-table td[contenteditable]:focus {
        background: #eff6ff;
        outline: 2px solid #3b82f6;
        outline-offset: -2px;
      }

      /* Flashcard Styles */
      .flashcard {
        perspective: 1000px;
        width: 100%;
        height: 300px;
        cursor: pointer;
      }
      .flashcard-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.6s;
        transform-style: preserve-3d;
      }
      .flashcard.flipped .flashcard-inner {
        transform: rotateY(180deg);
      }
      .flashcard-front, .flashcard-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem;
        border-radius: 1rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        border: 1px solid #e5e7eb;
        background: white;
        font-size: 1.25rem;
        font-weight: 500;
      }
      .flashcard-back {
        background: #eff6ff;
        transform: rotateY(180deg);
        color: #1e40af;
      }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-800">
    <!-- Top Header -->
    <header class="bg-white border-b border-gray-200 shadow-sm">
      <div class="px-6 py-3">
        <div class="flex justify-between items-center">
          <div class="flex items-center space-x-4">
            <div class="flex items-center">
              <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                <i class="fas fa-graduation-cap text-white"></i>
              </div>
              <h1 class="ml-3 text-xl font-bold text-gray-900">UWorld CPA</h1>
            </div>
            <div class="hidden md:block">
              <span class="text-sm font-medium text-blue-700 bg-blue-50 px-3 py-1 rounded-full"
                >FAR-2024</span
              >
            </div>
            <div class="hidden lg:block">
              <span class="text-sm font-medium text-gray-700"
                >Financial Accounting and Reporting</span
              >
            </div>
          </div>

          <div class="flex items-center space-x-4">
            <!-- Timer -->
            <div class="bg-red-50 border border-red-200 rounded-lg px-4 py-2 timer-pulse">
              <div class="flex items-center">
                <i class="fas fa-clock text-red-500 mr-2"></i>
                <span class="font-bold text-red-600 text-lg">00:04</span>
                <span class="text-red-500 text-sm ml-2">EXAM TIME ELAPSED</span>
              </div>
            </div>

            <!-- User Menu -->
            <div class="relative">
              <button
                class="flex items-center space-x-2 bg-gray-100 hover:bg-gray-200 rounded-lg px-3 py-2 transition"
              >
                <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                  <span class="text-white font-medium">JF</span>
                </div>
                <span class="hidden md:block font-medium">Jacob Floyd</span>
                <i class="fas fa-chevron-down text-gray-500"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Test Info Bar -->
      <div class="bg-blue-900 text-white">
        <div class="px-6 py-2">
          <div class="flex justify-between items-center">
            <div class="flex items-center space-x-6">
              <div class="flex items-center">
                <i class="fas fa-compass mr-2"></i>
                <span>Testlet 1</span>
              </div>
              <div class="hidden md:flex items-center">
                <i class="fas fa-hashtag mr-2"></i>
                <span>Question ID: 1702181</span>
              </div>
            </div>

            <div class="flex space-x-2">
              <button class="bg-blue-800 hover:bg-blue-700 px-4 py-1 rounded text-sm transition">
                <i class="fas fa-flag mr-1"></i> Mark for Review
              </button>
              <button class="bg-blue-800 hover:bg-blue-700 px-4 py-1 rounded text-sm transition">
                <i class="fas fa-question-circle mr-1"></i> Help
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <div class="flex h-screen pt-16">
      <!-- Left Sidebar - Question Navigation -->
      <aside class="hidden lg:block w-64 bg-white border-r border-gray-200 sidebar-transition">
        <div class="p-4">
          <h2 class="font-bold text-gray-800 mb-4">Question Navigator</h2>

          <div class="space-y-2">
            <div
              class="flex items-center p-3 rounded-lg bg-blue-50 border border-blue-200 question-highlight"
            >
              <div
                class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold"
              >
                1
              </div>
              <span class="ml-3 font-medium">Current</span>
              <i class="fas fa-pencil-alt ml-auto text-blue-500"></i>
            </div>

            <div class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer">
              <div
                class="w-8 h-8 bg-gray-200 text-gray-700 rounded-full flex items-center justify-center font-bold"
              >
                2
              </div>
              <span class="ml-3">TBS - Bonds Payable</span>
            </div>

            <div class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer">
              <div
                class="w-8 h-8 bg-gray-200 text-gray-700 rounded-full flex items-center justify-center font-bold"
              >
                3
              </div>
              <span class="ml-3">MCQ - Revenue Recognition</span>
            </div>

            <div class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer">
              <div
                class="w-8 h-8 bg-gray-200 text-gray-700 rounded-full flex items-center justify-center font-bold"
              >
                4
              </div>
              <span class="ml-3">TBS - Lease Accounting</span>
              <i class="fas fa-flag ml-auto text-amber-500"></i>
            </div>

            <div class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer">
              <div
                class="w-8 h-8 bg-gray-200 text-gray-700 rounded-full flex items-center justify-center font-bold"
              >
                5
              </div>
              <span class="ml-3">MCQ - EPS Calculation</span>
            </div>
          </div>

          <div class="mt-8">
            <h3 class="font-bold text-gray-800 mb-3">Tools & Resources</h3>

            <div class="grid grid-cols-2 gap-3">
              <button
                id="btn-calculator"
                class="bg-gray-100 hover:bg-gray-200 rounded-lg p-3 flex flex-col items-center justify-center transition"
              >
                <i class="fas fa-calculator text-blue-600 text-xl mb-2"></i>
                <span class="text-xs font-medium">Calculator</span>
              </button>

              <button
                id="btn-spreadsheet"
                class="bg-gray-100 hover:bg-gray-200 rounded-lg p-3 flex flex-col items-center justify-center transition"
              >
                <i class="fas fa-table text-blue-600 text-xl mb-2"></i>
                <span class="text-xs font-medium">Spreadsheet</span>
              </button>

              <button
                id="btn-notebook"
                class="bg-gray-100 hover:bg-gray-200 rounded-lg p-3 flex flex-col items-center justify-center transition"
              >
                <i class="fas fa-book text-blue-600 text-xl mb-2"></i>
                <span class="text-xs font-medium">Notebook</span>
              </button>

              <button
                id="btn-flashcards"
                class="bg-gray-100 hover:bg-gray-200 rounded-lg p-3 flex flex-col items-center justify-center transition"
              >
                <i class="fas fa-bolt text-blue-600 text-xl mb-2"></i>
                <span class="text-xs font-medium">Flashcards</span>
              </button>
            </div>
          </div>

          <div class="mt-8">
            <h3 class="font-bold text-gray-800 mb-3">Progress</h3>
            <div class="bg-gray-200 rounded-full h-2">
              <div class="bg-blue-600 rounded-full h-2 w-1/5"></div>
            </div>
            <div class="flex justify-between mt-2 text-sm text-gray-600">
              <span>1 of 5</span>
              <span>20%</span>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Question Area -->
      <main class="flex-1 overflow-auto scrollbar-thin">
        <div class="max-w-6xl mx-auto p-6">
          <!-- Question Header -->
          <div class="flex justify-between items-center mb-6">
            <div>
              <div class="flex items-center mb-2">
                <span class="text-sm font-medium text-blue-700 bg-blue-50 px-3 py-1 rounded-full"
                  >Task-Based Simulation</span
                >
                <span class="mx-3 text-gray-400">•</span>
                <span class="text-sm text-gray-600">Statement of Comprehensive Income</span>
              </div>
              <h1 class="text-2xl font-bold text-gray-900">
                Comprehensive Income Review - Carolina Enterprises
              </h1>
            </div>

            <div class="flex space-x-3">
              <button
                class="bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 px-4 rounded-lg transition flex items-center"
              >
                <i class="fas fa-chevron-left mr-2"></i> Previous
              </button>
              <button
                class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition flex items-center"
              >
                Next <i class="fas fa-chevron-right ml-2"></i>
              </button>
            </div>
          </div>

          <!-- Exhibits Section -->
          <div class="mb-6">
            <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
              <div class="bg-gray-50 px-5 py-3 border-b border-gray-200">
                <div class="flex justify-between items-center">
                  <h2 class="font-bold text-gray-800 flex items-center">
                    <i class="fas fa-folder-open text-blue-500 mr-2"></i> Exhibits (3)
                  </h2>
                  <div class="flex space-x-2">
                    <button class="text-gray-500 hover:text-blue-600 p-2 rounded">
                      <i class="fas fa-layer-group"></i>
                    </button>
                    <button class="text-gray-500 hover:text-blue-600 p-2 rounded">
                      <i class="fas fa-window-maximize"></i>
                    </button>
                    <button class="text-gray-500 hover:text-blue-600 p-2 rounded">
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </div>
              </div>

              <div class="p-5">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div
                    class="exhibit-hover bg-white border border-gray-200 rounded-lg p-4 cursor-pointer transition transform hover:shadow-md"
                  >
                    <div class="flex items-center mb-3">
                      <div
                        class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3"
                      >
                        <i class="fas fa-file-invoice-dollar text-blue-600"></i>
                      </div>
                      <div>
                        <h3 class="font-medium text-gray-900">Draft Statement</h3>
                        <p class="text-sm text-gray-500">Comprehensive Income</p>
                      </div>
                    </div>
                    <p class="text-gray-600 text-sm">
                      Draft of the Statement of Comprehensive Income for the year-ended December 31,
                      Year 6
                    </p>
                  </div>

                  <div
                    class="exhibit-hover bg-white border border-gray-200 rounded-lg p-4 cursor-pointer transition transform hover:shadow-md"
                  >
                    <div class="flex items-center mb-3">
                      <div
                        class="w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center mr-3"
                      >
                        <i class="fas fa-envelope text-amber-600"></i>
                      </div>
                      <div>
                        <h3 class="font-medium text-gray-900">Legal Dept Email</h3>
                        <p class="text-sm text-gray-500">Legal communication</p>
                      </div>
                    </div>
                    <p class="text-gray-600 text-sm">
                      Email from the Legal Department regarding derivative transactions
                    </p>
                  </div>

                  <div
                    class="exhibit-hover bg-white border border-gray-200 rounded-lg p-4 cursor-pointer transition transform hover:shadow-md"
                  >
                    <div class="flex items-center mb-3">
                      <div
                        class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center mr-3"
                      >
                        <i class="fas fa-chart-line text-emerald-600"></i>
                      </div>
                      <div>
                        <h3 class="font-medium text-gray-900">Investment Report</h3>
                        <p class="text-sm text-gray-500">Investment analysis</p>
                      </div>
                    </div>
                    <p class="text-gray-600 text-sm">
                      Report from the Investment Department on available-for-sale securities
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Question Content -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column - Question Text -->
            <div class="lg:col-span-2">
              <div
                class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden mb-6"
              >
                <div class="p-6">
                  <div class="flex items-center mb-4">
                    <div
                      class="w-10 h-10 bg-blue-100 text-blue-800 rounded-lg flex items-center justify-center font-bold text-lg mr-3"
                    >
                      1
                    </div>
                    <div>
                      <h2 class="font-bold text-gray-900">Task Instructions</h2>
                      <p class="text-sm text-gray-600">
                        Review the memorandum and make corrections
                      </p>
                    </div>
                  </div>

                  <div class="prose max-w-none">
                    <p class="text-gray-700 mb-4">
                      <strong>Scroll down to complete all parts of this task.</strong>
                    </p>

                    <p class="text-gray-700 mb-4">
                      Carolina Enterprises, Inc. is an international manufacturer of precious metals
                      jewelry. After looking over the statement of comprehensive income for the year
                      ended December 31, Year 6, Jacob Floyd, the controller, had several questions
                      regarding the items. He asked Janie Quan, the staff accountant, to review the
                      statement and make recommendations for changes.
                    </p>

                    <p class="text-gray-700 mb-6">
                      Review the memorandum from the staff accountant to the controller and make any
                      changes necessary to ensure it is accurate and consistent with the information
                      and documents provided in the exhibits. Assume that Carolina has a 30%
                      effective tax rate.
                    </p>

                    <div class="bg-gray-50 border-l-4 border-blue-500 p-4 mb-6">
                      <p class="text-gray-700">
                        To revise the memorandum, click on each segment of
                        <u class="text-blue-600 font-medium">underlined text</u> below and select
                        the needed correction, if any, from the list provided. If the underlined
                        text is already correct in the context of the memorandum, select
                        <span class="font-medium">[Original text]</span> from the list. If removal
                        of the entire underlined text is the best revision to the memorandum, select
                        <span class="font-medium">[Delete text]</span> from the list.
                      </p>
                    </div>

                    <!-- Memorandum -->
                    <div class="border border-gray-200 rounded-lg p-5 mb-6">
                      <div class="border-b border-gray-200 pb-3 mb-4">
                        <h3 class="font-bold text-lg text-gray-900">Carolina Enterprises, Inc.</h3>
                      </div>

                      <div class="space-y-4">
                        <div class="flex">
                          <div class="w-32 font-medium text-gray-700">To:</div>
                          <div>Jacob Floyd, Controller</div>
                        </div>

                        <div class="flex">
                          <div class="w-32 font-medium text-gray-700">From:</div>
                          <div>Janie Quan, Staff accountant</div>
                        </div>

                        <div class="flex">
                          <div class="w-32 font-medium text-gray-700">Date:</div>
                          <div>January 3, Year 7</div>
                        </div>

                        <div class="flex">
                          <div class="w-32 font-medium text-gray-700">Re:</div>
                          <div>
                            Review of the statement of comprehensive income for the year ended
                            December 31, Year 6
                          </div>
                        </div>
                      </div>

                      <div class="mt-6 pt-6 border-t border-gray-200">
                        <p class="text-gray-700 mb-4">
                          Per your request, I have reviewed the records and documents to determine
                          the accuracy of the statement of comprehensive income for the year ended
                          December 31, Year 6. Below are my findings.
                        </p>

                        <p class="text-gray-700 mb-4">
                          According to GAAP, comprehensive income may be presented in either one
                          statement or two statements.
                          <span
                            class="bg-amber-100 px-1 py-0.5 rounded border border-amber-300 font-medium cursor-pointer hover:bg-amber-200 transition"
                            >The two-statement approach presents the balance sheet immediately
                            followed by a second statement, a statement of comprehensive income,
                            which begins with accumulated other comprehensive income and displays
                            the components of other comprehensive income.</span
                          >
                          The company adopted the two-statement approach.
                        </p>

                        <p class="text-gray-700 mb-4">
                          No matter which approach is used, several items are required to be
                          separately stated as part of comprehensive income.
                          <span
                            class="bg-amber-100 px-1 py-0.5 rounded border border-amber-300 font-medium cursor-pointer hover:bg-amber-200 transition"
                            >These items include: translation gains and losses from foreign currency
                            transactions; net unrealized holding gains and losses (noncredit
                            related) on available-for-sale debt securities; excess adjustment of the
                            pension projected benefit obligation and fair value of plan assets; and
                            derivative cash flow hedges.</span
                          >
                        </p>

                        <p class="text-gray-700">
                          Based on my review of the transactions and documents, the draft of the
                          statement of comprehensive income for the year ended December 31, Year 6,
                          is incorrect.
                          <span
                            class="bg-amber-100 px-1 py-0.5 rounded border border-amber-300 font-medium cursor-pointer hover:bg-amber-200 transition"
                            >The following changes are required: The gain from discontinued
                            operations should be removed. The unrealized holding gain (noncredit
                            related) on available-for-sale debt securities (net of tax) should be
                            $10,500. Comprehensive income is $1,270,500.</span
                          >
                        </p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="bg-gray-50 px-6 py-4 border-t border-gray-200">
                  <div class="flex justify-between items-center">
                    <div class="text-sm text-gray-600">
                      <i class="fas fa-info-circle mr-1 text-blue-500"></i>
                      Click on underlined text to select the correct revision
                    </div>

                    <button
                      class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition"
                    >
                      Submit Answer
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right Column - Explanation & Resources -->
            <div class="lg:col-span-1">
              <!-- Toggle Answer View -->
              <div
                class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden mb-6"
              >
                <div class="border-b border-gray-200">
                  <div class="flex">
                    <button
                      class="flex-1 py-3 text-center font-medium border-b-2 border-blue-600 text-blue-600"
                    >
                      Your Answer
                    </button>
                    <button
                      class="flex-1 py-3 text-center font-medium text-gray-600 hover:text-gray-900"
                    >
                      Correct Answer
                    </button>
                  </div>
                </div>

                <div class="p-5">
                  <div class="text-center py-8">
                    <div
                      class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"
                    >
                      <i class="fas fa-clock text-gray-400 text-2xl"></i>
                    </div>
                    <h3 class="font-medium text-gray-900 mb-2">Answer Not Submitted</h3>
                    <p class="text-gray-600 text-sm">
                      Submit your answer to see results and explanation
                    </p>
                  </div>
                </div>
              </div>

              <!-- Explanation (Collapsed by Default) -->
              <div
                class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden mb-6"
              >
                <div class="bg-gray-50 px-5 py-3 border-b border-gray-200">
                  <h2 class="font-bold text-gray-800 flex items-center justify-between">
                    <span><i class="fas fa-lightbulb text-amber-500 mr-2"></i> Explanation</span>
                    <button class="text-gray-500 hover:text-gray-700">
                      <i class="fas fa-chevron-down"></i>
                    </button>
                  </h2>
                </div>

                <div class="p-5">
                  <div class="text-center py-4">
                    <p class="text-gray-600">
                      Submit your answer to unlock the detailed explanation
                    </p>
                  </div>
                </div>
              </div>

              <!-- Quick Reference -->
              <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                <div class="bg-gray-50 px-5 py-3 border-b border-gray-200">
                  <h2 class="font-bold text-gray-800 flex items-center">
                    <i class="fas fa-bookmark text-blue-500 mr-2"></i> Quick Reference
                  </h2>
                </div>

                <div class="p-5">
                  <div class="space-y-4">
                    <div>
                      <h3 class="font-medium text-gray-900 mb-2">
                        Comprehensive Income Components
                      </h3>
                      <ul class="text-sm text-gray-600 space-y-1">
                        <li class="flex items-start">
                          <i class="fas fa-check text-emerald-500 mt-0.5 mr-2 text-xs"></i>
                          Foreign currency translation adjustments
                        </li>
                        <li class="flex items-start">
                          <i class="fas fa-check text-emerald-500 mt-0.5 mr-2 text-xs"></i>
                          Unrealized gains/losses on AFS securities
                        </li>
                        <li class="flex items-start">
                          <i class="fas fa-check text-emerald-500 mt-0.5 mr-2 text-xs"></i>
                          Pension plan adjustments
                        </li>
                        <li class="flex items-start">
                          <i class="fas fa-check text-emerald-500 mt-0.5 mr-2 text-xs"></i>
                          Cash flow hedge derivatives
                        </li>
                      </ul>
                    </div>

                    <div class="pt-4 border-t border-gray-100">
                      <h3 class="font-medium text-gray-900 mb-2">Key Formula</h3>
                      <div class="bg-gray-50 p-3 rounded-lg text-sm">
                        <p class="font-medium text-gray-800">
                          Comprehensive Income = Net Income + Other Comprehensive Income
                        </p>
                      </div>
                    </div>

                    <div class="pt-4 border-t border-gray-100">
                      <h3 class="font-medium text-gray-900 mb-2">Related Standards</h3>
                      <div class="text-sm">
                        <p class="text-gray-600">ASC 220, IAS 1</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bottom Action Bar -->
        <div class="sticky bottom-0 bg-white border-t border-gray-200 shadow-lg">
          <div class="px-6 py-3">
            <div class="flex justify-between items-center">
              <div class="flex space-x-3">
                <button class="flex items-center text-gray-700 hover:text-blue-600 transition">
                  <i class="fas fa-flag mr-2"></i> Flag Question
                </button>
                <button class="flex items-center text-gray-700 hover:text-blue-600 transition">
                  <i class="fas fa-sticky-note mr-2"></i> Add Note
                </button>
                <button class="flex items-center text-gray-700 hover:text-blue-600 transition">
                  <i class="fas fa-question-circle mr-2"></i> Need Help?
                </button>
              </div>

              <div class="flex space-x-3">
                <button
                  class="bg-white border border-gray-300 hover:bg-gray-50 text-gray-800 font-medium py-2 px-5 rounded-lg transition"
                >
                  Suspend Testlet
                </button>
                <button
                  class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-5 rounded-lg transition"
                >
                  Submit Testlet
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Mobile Bottom Navigation -->
    <div
      class="lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-10"
    >
      <div class="flex justify-around p-3">
        <button class="flex flex-col items-center text-blue-600">
          <i class="fas fa-question-circle text-lg mb-1"></i>
          <span class="text-xs">Questions</span>
        </button>
        <button class="flex flex-col items-center text-gray-600">
          <i class="fas fa-calculator text-lg mb-1"></i>
          <span class="text-xs">Calculator</span>
        </button>
        <button class="flex flex-col items-center text-gray-600">
          <i class="fas fa-flag text-lg mb-1"></i>
          <span class="text-xs">Review</span>
        </button>
        <button class="flex flex-col items-center text-gray-600">
          <i class="fas fa-cog text-lg mb-1"></i>
          <span class="text-xs">Settings</span>
        </button>
      </div>
    </div>

    <script>
      // Enhanced Interactive Functionality
      document.addEventListener("DOMContentLoaded", function () {
        
        // --- 1. Toast Notification System ---
        const toastContainer = document.createElement('div');
        toastContainer.className = 'toast-container';
        document.body.appendChild(toastContainer);

        window.showToast = function(message, type = 'info') {
          const toast = document.createElement('div');
          toast.className = `toast toast-${type}`;
          
          let icon = 'info-circle';
          let color = 'text-blue-500';
          if (type === 'success') { icon = 'check-circle'; color = 'text-emerald-500'; }
          if (type === 'warning') { icon = 'exclamation-triangle'; color = 'text-amber-500'; }
          if (type === 'error') { icon = 'times-circle'; color = 'text-red-500'; }

          toast.innerHTML = `
            <i class="fas fa-${icon} ${color} text-xl mr-3"></i>
            <span class="font-medium text-gray-800">${message}</span>
          `;
          
          toastContainer.appendChild(toast);
          
          // Trigger reflow
          void toast.offsetWidth; 
          toast.classList.add('show');

          setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 400);
          }, 3000);
        };

        // --- 2. Modal System for Exhibits ---
        const modalOverlay = document.createElement('div');
        modalOverlay.className = 'modal-overlay';
        modalOverlay.innerHTML = `
          <div class="modal-content">
            <div class="flex justify-between items-center mb-4 border-b pb-2">
              <h3 class="text-xl font-bold text-gray-900" id="modal-title">Exhibit</h3>
              <button class="text-gray-400 hover:text-gray-600 transition" onclick="closeModal()">
                <i class="fas fa-times text-xl"></i>
              </button>
            </div>
            <div id="modal-body" class="prose max-w-none text-gray-700"></div>
            <div class="mt-6 flex justify-end">
              <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition" onclick="closeModal()">Close</button>
            </div>
          </div>
        `;
        document.body.appendChild(modalOverlay);

        window.openModal = function(title, content) {
          document.getElementById('modal-title').textContent = title;
          document.getElementById('modal-body').innerHTML = content;
          modalOverlay.classList.add('active');
        };

        window.closeModal = function() {
          modalOverlay.classList.remove('active');
        };

        modalOverlay.addEventListener('click', (e) => {
          if (e.target === modalOverlay) closeModal();
        });

        // Exhibit Data
        const exhibitData = {
          'Draft Statement': `
            <div class="border p-4 bg-white shadow-sm">
              <h4 class="text-center font-bold mb-4">Carolina Enterprises, Inc.<br>Statement of Comprehensive Income (Draft)<br>Year Ended December 31, Year 6</h4>
              <table class="w-full text-sm">
                <tr class="border-b"><td class="py-2">Net Income</td><td class="text-right">$1,250,000</td></tr>
                <tr class="border-b"><td class="py-2">Other Comprehensive Income:</td><td></td></tr>
                <tr><td class="pl-4 py-1">Foreign currency translation gain</td><td class="text-right">15,000</td></tr>
                <tr><td class="pl-4 py-1">Unrealized holding gain on AFS securities</td><td class="text-right">15,000</td></tr>
                <tr class="font-bold border-t"><td class="py-2">Comprehensive Income</td><td class="text-right">$1,280,000</td></tr>
              </table>
            </div>`,
          'Legal Dept Email': `
            <div class="bg-gray-50 p-4 rounded border">
              <p><strong>From:</strong> Legal Dept<br><strong>To:</strong> Controller<br><strong>Subject:</strong> Derivative Transactions</p>
              <hr class="my-2">
              <p>The cash flow hedge was effective during the year. The gain on the effective portion was $5,000 before tax.</p>
            </div>`,
          'Investment Report': `
            <div class="bg-gray-50 p-4 rounded border">
              <p><strong>Available-for-Sale Securities Analysis:</strong></p>
              <p>Total unrealized holding gain: $15,000 (pre-tax).</p>
              <p>Note: No credit losses were recognized.</p>
            </div>`
        };

        const exhibitCards = document.querySelectorAll(".exhibit-hover");
        exhibitCards.forEach((card) => {
          card.addEventListener("click", function () {
            const title = this.querySelector("h3").textContent;
            const content = exhibitData[title] || "<p>Exhibit content loading...</p>";
            openModal(title, content);
          });
        });

        // --- 3. Popover System for Corrections ---
        const popover = document.createElement('div');
        popover.className = 'correction-popover';
        document.body.appendChild(popover);
        let activeElement = null;

        function closePopover() {
          popover.classList.remove('active');
          activeElement = null;
        }

        document.addEventListener('click', (e) => {
          if (!popover.contains(e.target) && activeElement && !activeElement.contains(e.target)) {
            closePopover();
          }
        });

        const underlinedTexts = document.querySelectorAll(".bg-amber-100");
        underlinedTexts.forEach((text) => {
          text.addEventListener("click", function (e) {
            e.stopPropagation();
            
            // If clicking the same element, toggle off
            if (activeElement === this) {
              closePopover();
              return;
            }
            activeElement = this;

            // Define options based on text content (mock logic)
            const options = [
              { text: "[Original text]", action: () => showToast("Kept original text", "info") },
              { text: "[Delete Text]", action: () => { 
                  this.classList.add('line-through', 'text-gray-400', 'bg-transparent'); 
                  this.classList.remove('bg-amber-100', 'border');
                  showToast("Text deleted", "warning"); 
                } 
              },
              { text: "Corrected version A...", action: () => {
                  this.textContent = "Corrected version A selected...";
                  this.classList.add('bg-green-100', 'border-green-300');
                  this.classList.remove('bg-amber-100', 'border-amber-300');
                  showToast("Correction applied", "success");
                } 
              }
            ];

            // Build Popover Content
            popover.innerHTML = '';
            options.forEach(opt => {
              const div = document.createElement('div');
              div.className = 'correction-option text-sm text-gray-700';
              div.textContent = opt.text;
              div.onclick = () => {
                opt.action();
                closePopover();
              };
              popover.appendChild(div);
            });

            // Position Popover
            const rect = this.getBoundingClientRect();
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            popover.style.top = `${rect.bottom + scrollTop + 5}px`;
            popover.style.left = `${Math.min(rect.left, window.innerWidth - 360)}px`; // Prevent overflow
            popover.classList.add('active');
          });
        });

        // --- 4. Answer View Toggle & Submission ---
        const answerToggleButtons = document.querySelectorAll(".bg-white.rounded-xl.border button");
        answerToggleButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const parent = this.closest(".border-b");
            parent.querySelectorAll("button").forEach((btn) => {
              btn.classList.remove("border-b-2", "border-blue-600", "text-blue-600");
              btn.classList.add("text-gray-600");
            });
            this.classList.add("border-b-2", "border-blue-600", "text-blue-600");
            this.classList.remove("text-gray-600");
          });
        });

        // Submit Button Logic
        const submitBtn = document.querySelector("button.bg-blue-600.hover\\:bg-blue-700.text-white.font-medium.py-2.px-6");
        if(submitBtn) {
            submitBtn.addEventListener('click', () => {
                showToast("Evaluating answer...", "info");
                setTimeout(() => {
                    showToast("Answer Submitted Successfully!", "success");
                    // Reveal explanation
                    const explanation = document.querySelector(".fa-lightbulb").closest(".rounded-xl");
                    const body = explanation.querySelector(".p-5");
                    body.innerHTML = `
                        <div class="text-green-700 bg-green-50 p-4 rounded-lg border border-green-200">
                            <h4 class="font-bold mb-2">Correct Answer</h4>
                            <p class="text-sm">The available-for-sale securities gain should be reported net of tax. $15,000 × (1 - 30%) = $10,500.</p>
                        </div>
                    `;
                }, 1000);
            });
        }

        // --- 5. Interactive Tools Implementation ---
        
        // Tool Content Generators
        const tools = {
          calculator: () => {
            return `
              <div class="max-w-xs mx-auto">
                <div class="calc-display" id="calc-display">0</div>
                <div class="calc-grid" id="calc-keys">
                  <button class="calc-btn text-gray-500" data-action="clear">AC</button>
                  <button class="calc-btn text-gray-500" data-action="delete">DEL</button>
                  <button class="calc-btn operator" data-action="operator" data-val="%">%</button>
                  <button class="calc-btn operator" data-action="operator" data-val="/">/</button>
                  
                  <button class="calc-btn" data-val="7">7</button>
                  <button class="calc-btn" data-val="8">8</button>
                  <button class="calc-btn" data-val="9">9</button>
                  <button class="calc-btn operator" data-action="operator" data-val="*">×</button>
                  
                  <button class="calc-btn" data-val="4">4</button>
                  <button class="calc-btn" data-val="5">5</button>
                  <button class="calc-btn" data-val="6">6</button>
                  <button class="calc-btn operator" data-action="operator" data-val="-">-</button>
                  
                  <button class="calc-btn" data-val="1">1</button>
                  <button class="calc-btn" data-val="2">2</button>
                  <button class="calc-btn" data-val="3">3</button>
                  <button class="calc-btn operator" data-action="operator" data-val="+">+</button>
                  
                  <button class="calc-btn" data-val="0">0</button>
                  <button class="calc-btn" data-val=".">.</button>
                  <button class="calc-btn equal" data-action="calculate">=</button>
                </div>
              </div>
            `;
          },
          spreadsheet: () => {
            let rows = '';
            for(let i=1; i<=10; i++) {
              rows += `<tr>
                <td>${i}</td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
              </tr>`;
            }
            return `
              <div class="spreadsheet-container">
                <table class="spreadsheet-table">
                  <thead>
                    <tr>
                      <th></th>
                      <th>A</th>
                      <th>B</th>
                      <th>C</th>
                      <th>D</th>
                    </tr>
                  </thead>
                  <tbody>${rows}</tbody>
                </table>
                <div class="mt-4 text-sm text-gray-500">
                  <i class="fas fa-info-circle mr-1"></i> Cells are editable. Data is not saved in this prototype.
                </div>
              </div>
            `;
          },
          notebook: () => {
            const savedNote = localStorage.getItem('cpa-notebook-content') || '';
            return `
              <div class="flex flex-col h-96">
                <div class="flex justify-between items-center mb-2">
                  <span class="text-sm text-gray-500" id="save-status">Auto-saved to local storage</span>
                  <button class="text-sm text-red-500 hover:text-red-700" onclick="document.getElementById('notebook-area').value=''; localStorage.removeItem('cpa-notebook-content');">Clear</button>
                </div>
                <textarea 
                  id="notebook-area" 
                  class="flex-1 w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none font-mono text-sm"
                  placeholder="Type your notes here..."
                >${savedNote}</textarea>
              </div>
            `;
          },
          flashcards: () => {
            return `
              <div class="flex flex-col items-center">
                <div class="flashcard mb-6" onclick="this.classList.toggle('flipped')">
                  <div class="flashcard-inner">
                    <div class="flashcard-front">
                      <div>
                        <span class="block text-xs text-gray-400 uppercase tracking-wide mb-2">Term</span>
                        Comprehensive Income
                      </div>
                    </div>
                    <div class="flashcard-back">
                      <div>
                        <span class="block text-xs text-blue-300 uppercase tracking-wide mb-2">Definition</span>
                        The change in equity (net assets) of a business enterprise during a period from transactions and other events and circumstances from nonowner sources.
                      </div>
                    </div>
                  </div>
                </div>
                <div class="flex space-x-4">
                  <button class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg transition" onclick="showToast('Previous card (prototype)', 'info')">
                    <i class="fas fa-arrow-left mr-2"></i> Prev
                  </button>
                  <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition" onclick="showToast('Next card (prototype)', 'info')">
                    Next <i class="fas fa-arrow-right ml-2"></i>
                  </button>
                </div>
              </div>
            `;
          }
        };

        // Attach Listeners
        document.getElementById('btn-calculator').addEventListener('click', () => {
          openModal('Calculator', tools.calculator());
          initCalculator();
        });

        document.getElementById('btn-spreadsheet').addEventListener('click', () => {
          openModal('Spreadsheet', tools.spreadsheet());
        });

        document.getElementById('btn-notebook').addEventListener('click', () => {
          openModal('Notebook', tools.notebook());
          initNotebook();
        });

        document.getElementById('btn-flashcards').addEventListener('click', () => {
          openModal('Flashcards', tools.flashcards());
        });

        // Tool Initialization Logic
        function initCalculator() {
          const display = document.getElementById('calc-display');
          const keys = document.getElementById('calc-keys');
          let currentInput = '0';
          let previousInput = '';
          let operator = null;
          let newNumber = true;

          keys.addEventListener('click', e => {
            if (!e.target.matches('button')) return;
            
            const btn = e.target;
            const action = btn.dataset.action;
            const val = btn.dataset.val;

            if (!action) { // Number
              if (newNumber) {
                currentInput = val === '.' ? '0.' : val;
                newNumber = false;
              } else {
                if (val === '.' && currentInput.includes('.')) return;
                currentInput += val;
              }
              display.textContent = currentInput;
            } else if (action === 'operator') {
              previousInput = currentInput;
              operator = val;
              newNumber = true;
            } else if (action === 'calculate') {
              if (operator && previousInput) {
                try {
                  const prev = parseFloat(previousInput);
                  const current = parseFloat(currentInput);
                  let result = 0;
                  switch(operator) {
                    case '+': result = prev + current; break;
                    case '-': result = prev - current; break;
                    case '*': result = prev * current; break;
                    case '/': result = prev / current; break;
                    case '%': result = prev % current; break;
                  }
                  currentInput = result.toString();
                  display.textContent = currentInput;
                  operator = null;
                  newNumber = true;
                } catch (err) {
                  display.textContent = 'Error';
                  currentInput = '0';
                  newNumber = true;
                }
              }
            } else if (action === 'clear') {
              currentInput = '0';
              previousInput = '';
              operator = null;
              newNumber = true;
              display.textContent = '0';
            } else if (action === 'delete') {
              currentInput = currentInput.slice(0, -1) || '0';
              display.textContent = currentInput;
            }
          });
        }

        function initNotebook() {
          const textarea = document.getElementById('notebook-area');
          if(!textarea) return;
          
          textarea.addEventListener('input', (e) => {
            localStorage.setItem('cpa-notebook-content', e.target.value);
            const status = document.getElementById('save-status');
            status.textContent = 'Saving...';
            setTimeout(() => status.textContent = 'Saved to local storage', 500);
          });
        }

        // Generic button handler for other buttons
        const otherButtons = document.querySelectorAll("button:not([id^='btn-'])");
        otherButtons.forEach(btn => {
            if (btn.closest(".modal-content") || btn.closest(".bg-white.rounded-xl.border") || btn === submitBtn) return;
            
            const btnText = btn.textContent.trim();
            if (btnText.includes('Mark for Review')) {
                 btn.addEventListener('click', () => showToast("Question marked for review", "warning"));
            }
            if (btnText.includes('Help')) {
                 btn.addEventListener('click', () => showToast("Help center opened", "info"));
            }
        });

        // --- 6. Improved Timer ---
        let seconds = 4;
        const timerElement = document.querySelector(".font-bold.text-red-600.text-lg");
        
        setInterval(() => {
          seconds++;
          const minutes = Math.floor(seconds / 60);
          const secs = seconds % 60;
          timerElement.textContent = `${minutes.toString().padStart(2, "0")}:${secs.toString().padStart(2, "0")}`;
          
          // Warning effect
          if (seconds % 60 === 0) {
              timerElement.parentElement.classList.add('animate-pulse');
              setTimeout(() => timerElement.parentElement.classList.remove('animate-pulse'), 2000);
          }
        }, 1000);

      });
    </script>
  </body>
</html>
